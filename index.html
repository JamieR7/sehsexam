<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IB SEHS Question Bank</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .filter-section {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-section label {
            font-weight: 600;
            color: #2c3e50;
        }

        .filter-section select {
            padding: 10px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 15px;
            background: white;
            cursor: pointer;
            min-width: 350px;
            font-weight: 500;
        }

        .filter-section select:focus {
            outline: none;
            border-color: #3498db;
        }

        .question-count {
            color: #7f8c8d;
            font-size: 14px;
            margin-left: auto;
        }

        .question-card {
            background: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .question-header {
            margin-bottom: 20px;
        }

        .question-meta {
            color: #7f8c8d;
            font-size: 13px;
            margin-bottom: 10px;
        }

        .section-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: 600;
            font-size: 12px;
            margin-right: 8px;
        }

        .section-a { background: #ffeaa7; color: #d63031; }
        .section-b { background: #74b9ff; color: #0984e3; }
        .section-c { background: #a29bfe; color: #6c5ce7; }

        .question-code {
            color: #9b59b6;
            font-family: monospace;
            font-size: 12px;
            margin-left: 10px;
        }

        .question-text {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .marks-badge {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-family: inherit;
            font-size: 15px;
            resize: vertical;
            margin: 20px 0;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-primary:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
            margin-left: 10px;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .feedback-section {
            margin-top: 30px;
            padding: 20px;
            background: #ecf0f1;
            border-radius: 6px;
            display: none;
        }

        .feedback-section.show {
            display: block;
        }

        .score-display {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .disclaimer {
            font-size: 13px;
            color: #7f8c8d;
            font-style: italic;
            margin-bottom: 20px;
        }

        .key-points {
            margin: 20px 0;
        }

        .key-point {
            padding: 8px 12px;
            margin: 6px 0;
            border-radius: 4px;
            font-size: 14px;
        }

        .key-point.hit {
            background: #d5f4e6;
            color: #27ae60;
        }

        .key-point.miss {
            background: #fadbd8;
            color: #e74c3c;
        }

        .examiner-comment {
            background: white;
            padding: 15px;
            border-left: 4px solid #3498db;
            border-radius: 4px;
            margin: 20px 0;
        }

        .examiner-comment strong {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
        }

        .hint-section, .markscheme-section {
            background: white;
            padding: 20px;
            border-radius: 6px;
            margin-top: 15px;
            display: none;
        }

        .hint-section.show, .markscheme-section.show {
            display: block;
        }

        .hint-section {
            border-left: 4px solid #f39c12;
        }

        .markscheme-section {
            border-left: 4px solid #9b59b6;
        }

        .closing-message {
            margin-top: 20px;
            padding: 15px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            border-radius: 4px;
            font-size: 14px;
            color: #856404;
        }

        .loading {
            display: none;
            color: #3498db;
            margin-left: 10px;
        }

        .loading.show {
            display: inline;
        }

        .examiner-report {
            margin-top: 15px;
            padding: 12px;
            background: #e8f4f8;
            border-radius: 4px;
            font-size: 14px;
        }

        .examiner-report strong {
            display: block;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .no-questions {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>IB SEHS Question Bank</h1>
            <p class="subtitle">Practice questions with AI-powered feedback using Claude Sonnet 4.5 with extended thinking</p>

            <div class="filter-section">
                <label for="section-filter">Select Section:</label>
                <select id="section-filter" onchange="filterQuestions()">
                    <option value="all">All Sections</option>
                    <option value="A">A. Exercise Physiology & Nutrition</option>
                    <option value="B">B. Biomechanics</option>
                    <option value="C">C. Sports Psychology & Motor Learning</option>
                </select>
                <span class="question-count" id="question-count"></span>
            </div>
        </header>

        <div id="questions-container"></div>
        <div id="no-questions" class="no-questions" style="display: none;">
            No questions available for this section yet.
        </div>
    </div>

    <script>
        // Question database
        const QUESTIONS = [
        {
                "id": "A-001",
                "code": "25M.1B.SL.TZ3.5a",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.1 Anatomy",
                "subtopic": "Synovial Joints",
                "question": "Outline four features of a synovial joint.",
                "max_marks": 4,
                "mark_scheme": "Articular cartilage: Smooth connective tissue at the end of articulating bones / Protects the bones from friction/shock absorption\n\nSynovial membrane: Surrounds the joint and provides stability / Secretes synovial fluid\n\nSynovial fluid: Provides lubrication for the joint / Enables the joint to move freely\n\nBursae: Fluid filled sac between a tendon and bone / Reduces friction between tendon bones/shock absorption\n\nLigament: Tough/elastic tissue connects bone to bone / Provides stability at the joint\n\nMeniscus: Thick pad of fibro cartilage which acts as a shock absorber/load distributer/lubricates the joint / Increases stability at the knee joint\n\nArticular capsule: Thick fibrous structure surrounding the entire joint / Holds the articulating bones/synovial membrane in place\n\nAward max 1 per feature.\nAward max 1 for a list of three or more features of synovial joints.",
                "examiner_report": "Many students confused the feature of a synovial joint as outlined in the guide with general statements regarding synovial joints i.e. freely movable."
        },
        {
                "id": "A-002",
                "code": "25M.2.SL.TZ2.6e",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.1 Anatomy",
                "subtopic": "Synovial Joint Features",
                "question": "Outline two features of synovial joints.",
                "max_marks": 2,
                "mark_scheme": "Articular cartilage: a glassy smooth layer surrounding the ends of the bones to reduce friction between bones\n\nSynovial membrane: lining of articular capsule that produces the synovial fluid, which aids lubrication\n\nSynovial fluid: acts as a lubricant, allows bones to smoothly move past each other\n\nBursae: synovial fluid-filled sac, sits between the tendon and bone to reduce friction\n\nMeniscus: semi-lunar disc of fibrous cartilage, provides cushioning and stability to joint\n\nLigament: strong, flexible tissue that connects bone to bone\n\nArticular capsule: sleeve-like structure surrounding joint, protects against dislocation\n\nZero (0) marks for a list.",
                "examiner_report": "Students could list features but they struggled to then outline the features."
        },
        {
                "id": "A-003",
                "code": "25M.2.SL.TZ2.5c",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.1 Anatomy",
                "subtopic": "Muscle Action",
                "question": "Analyse how the muscles work in pairs to extend the elbow during a backhand in badminton.",
                "max_marks": 4,
                "mark_scheme": "Is a neuromuscular reflex that inhibits opposing muscles to enable voluntary movements OR Is due to reciprocal inhibition to enable voluntary movements\n\nThe antagonist is inhibited to allow the agonist to contract and control the movement\n\nTriceps brachii act as agonist/contracts\n\nConcentric contraction\n\nBiceps brachii act as antagonist/relax/inhibited\n\nDo not accept biceps relax eccentrically.",
                "examiner_report": "Students appeared to describe the muscle actions prior to the movement indicated. Some continue to think that the biceps contracts eccentrically as the elbow extends through the movement."
        },
        {
                "id": "A-004",
                "code": "25M.2.SL.TZ1.4c",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.2 Exercise Physiology",
                "subtopic": "ATP-CP System",
                "question": "Describe the re-synthesis of ATP by the ATP-CP system.",
                "max_marks": 4,
                "mark_scheme": "Creatine phosphate(CP/PCr) is a high-energy molecule/fuel\n\nThe system uses the enzyme creatine kinase\n\nCP releases energy (exothermic reaction) and phosphate molecule(Pi)\n\nEnergy released is used to add Pi to ADP/re-synthesise ATP (endothermic reaction)\n\nReaction is a coupled reaction where one reaction is linked to another reaction\n\nThe reactions take place in the sarcoplasm/cytoplasm of muscle cell\n\n1 PC \u2192 1ATP\n\nDoes not require oxygen/anaerobic\n\nIs the first system to provide ATP/occurs up to first 20 seconds of exercise\n\nAccept a reaction equation for MP1-3, when sufficient/similar information is presented.\nAccept anything up to 20 seconds.",
                "examiner_report": "Students did not always make the relationship between the reaction to energy evident in their answers."
        },
        {
                "id": "A-005",
                "code": "25M.2.SL.TZ1.4d",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.2 Exercise Physiology",
                "subtopic": "Gaseous Exchange",
                "question": "Describe the process of gaseous exchange at the alveoli during rest and exercise.",
                "max_marks": 6,
                "mark_scheme": "Gases diffuse across the alveoli membrane\n\nPPO2 is higher in air breathed in/alveoli/lungs compared to blood\n\nPPCO2 is higher in the capillary blood compared to the air breathed in/alveoli/lungs\n\nNet movement of gases is from high to low PP/down a PP gradient\n\nThe PP gradient is maintained due to ventilation/blood flow\n\nDiffusion is facilitated by the thin/moist barrier/large alveoli surface area/short diffusion pathway\n\nDuring exercise:\nRate of diffusion increases during exercise due to a steeper PP gradient\n\nGreater volumes of gaseous exchange when exercising compared to rest\n\nAccept concentration instead of PP/partial pressure.\nAccept answers in the converse where appropriate.\nMax 5 if no reference to the effects of exercise on the process.",
                "examiner_report": "Overall, well answered. Some students discussed ventilation instead of gas exchange, or that the movement of gases was an exchange of carbon dioxide with oxygen."
        },
        {
                "id": "A-006",
                "code": "25M.2.SL.TZ1.5c",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.2 Exercise Physiology",
                "subtopic": "Energy Systems",
                "question": "Discuss the factors that determine the dominant energy system.",
                "max_marks": 5,
                "mark_scheme": "Intensity of activity\nE.g. in explosive activities the dominant activity is the ATP-PC system OR E.g. sprint finish which will cause a switch from aerobic to anaerobic\n\nDuration of activity\nE.g. 100 m will be dominated by ATP-PC, 800 m anaerobic glycolysis, marathon aerobic\n\nAvailability of fuel sources OR Availability of oxygen\nE.g. not having sufficient ATP-PC drives energy system to anaerobic glycolysis OR E.g. previous interval training depletes muscle glycogen and reduces the use of anaerobic/aerobic glycolysis and causes a switch to fat oxidation\n\nThe amount of recovery time available\nE.g. submaximal activity/passive rest to replenish PC OR E.g. sufficient time to rid the body of negative by-products hydrogen ions/lactate\n\nMax 2 for each given factor.\nMax 3 for stating the factors with no relevant example/explanation.",
                "examiner_report": "Most students could state intensity and/or duration as a factor. Few discussed the amount of recovery time."
        },
        {
                "id": "A-007",
                "code": "25M.2.SL.TZ1.5d",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.2 Exercise Physiology",
                "subtopic": "Blood Redistribution",
                "question": "Describe blood redistribution as a soccer (football) player begins running during a game.",
                "max_marks": 5,
                "mark_scheme": "As the soccer player begins running:\n\nIncreases blood acidity/temperature/CO2 causing a redistribution of blood OR Sympathetic stimulation/nervous system controls the vascular shunt/redistribution of blood\n\nDilation:\nQ/blood is redistribution to working/active muscles/tissues\n\nThrough vasodilation of arterioles to working muscle\n\nSome blood is directed to the skin (vasodilation) for cooling purposes\n\nConstriction:\nThrough vasoconstriction of arterioles to non-active tissues\n\nQ/blood is directed away from non-active tissues e.g. kidneys\n\nAccept any suitably annotated diagram explained for each part.",
                "examiner_report": "Few students indicated MP1, but identified the redistribution of blood to muscle tissues."
        },
        {
                "id": "A-008",
                "code": "25M.2.SL.TZ1.103a",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.3 Energy & Nutrition",
                "subtopic": "Glycemic Index",
                "question": "Explain the importance of selecting low glycemic index (GI) carbohydrates for a pre-competition meal.",
                "max_marks": 2,
                "mark_scheme": "GI is a measure of the rate at which carbohydrates raise blood glucose levels after being consumed\n\nLow-GI foods are absorbed slowly, causing a gradual increase in blood sugar\n\nThis provides consistent energy, beneficial for maintaining endurance during the event/prevent premature fatigue for endurance athletes\n\nAccept only marks for low GI.",
                "examiner_report": "This was a challenging question as it required a degree of analysis. Most responses addressed the benefits of low GI foods before competition but did not fully explain how those benefits transpired in a performance boost."
        },
        {
                "id": "A-009",
                "code": "25M.2.SL.TZ1.103c",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.3 Energy & Nutrition",
                "subtopic": "Hydration",
                "question": "Outline two reasons why hydration is important for an endurance swimmer.",
                "max_marks": 2,
                "mark_scheme": "Avoiding dehydration, crucial for performance during prolonged exercise\n\nMaintaining body temperature/thermoregulation especially in the varying temperatures of open water swimming\n\nFacilitates metabolic processes e.g. energy production crucial for sustaining the high energy demands of endurance swimming\n\nHydration enables efficient transport of nutrients/removal of metabolic waste\n\nTo reduce cardiovascular drift\n\nAnswers must be linked to performance.",
                "examiner_report": "This question was not answered well. Students provided a general reason for the importance of hydration in athletics but did not specifically relate it to endurance sports like swimming."
        },
        {
                "id": "A-010",
                "code": "25M.2.SL.TZ1.5b",
                "document": "A-SAQ",
                "section": "A",
                "section_name": "Exercise Physiology & Nutrition",
                "topic": "3.6 Training Principles",
                "subtopic": "Key Principles",
                "question": "Periodization and progression can be used to optimize an athlete's performance. Explain how a coach uses the other key principles of training to maximize athletic development.",
                "max_marks": 4,
                "mark_scheme": "Overload: Coach plans to increase intensity/frequency/time/FID of sessions with appropriate rest to elicit beneficial adaptations\nE.g. Increasing frequency of training per week\n\nSpecificity: Coach plans sessions that focus on developing muscles/skills/energy systems/movement patterns/strategy that are relevant for their performance\nE.g. Sprinter developing leg muscles\n\nReversibility: Coach needs to plan sessions/training/recovery to ensure that the loss of any performance gains does not occur\nE.g. Schedule practice two days after performance\n\nVariety: To maintain motivation/prevent boredom, coach plans a range of activities/methods\nE.g. CrossFit training\n\nMax 2 per principle (1 for explanation, 1 for example).\nDo not accept reference to periodisation or progression.\nDo not accept a list of key principles.\nMust explain how the principle is used to optimize performance.",
                "examiner_report": "Most students were able to obtain at least 1 mark. Some provided no examples, or examples that were too general."
        },
        {
                "id": "B-001",
                "code": "25M.2.SL.TZ1.5a",
                "document": "B-SAQ",
                "section": "B",
                "section_name": "Biomechanics",
                "topic": "3.4 Biomechanics",
                "subtopic": "Newton's Laws",
                "question": "Using examples, outline Newton's three laws of motion during a soccer (football) match.",
                "max_marks": 6,
                "mark_scheme": "First law:\nA body will continue in a state of rest/uniform motion unless acted upon by an external/internal force\nE.g. the ball will remain on the penalty spot until a player kicks the ball\nE.g. once kicked a ball remains in uniform motion until acted on by air resistance/gravity/friction/impact\n\nSecond law:\nF=ma/Acceleration is proportional to the net force, and is inversely proportional to the mass\nE.g. when the ball is struck by the player's foot in a free kick the player applies a force to ball which causes the ball to accelerate in direction of the force\nE.g. the greater the force applied by a football player to a ball during a free kick the faster the ball will accelerate towards goal\n\nThird law:\nFor every action force there is an equal and opposite reaction force\nE.g. the player applies an action force to the ball where an equal and opposite force is applied to the player\nE.g. The differences in the apparent acceleration of the ball compared to the player is due to the differences in mass between the ball and player\n\nMax 2 per law (1 for the law, 1 for the example).\nAccept all appropriate examples from any type of football.",
                "examiner_report": "Overall, well answered. However, there remains some confusion with the second law and descriptions of the mass/acceleration of the kicking leg."
        },
        {
                "id": "B-002",
                "code": "25M.2.HL.TZ3.8a",
                "document": "B-SAQ",
                "section": "B",
                "section_name": "Biomechanics",
                "topic": "3.4 Biomechanics",
                "subtopic": "Drag",
                "question": "Describe two types of drag and how each affects a cyclist.",
                "max_marks": 4,
                "mark_scheme": "Surface drag:\nAs a body moves through a fluid, its outer surface catches a layer of the fluid nearby, slowing it down\nThe smoother the surface of the cyclist, the lower the drag\n\nForm drag:\nAs a body pushes against a fluid, the fluid pushes back (action and reaction) creating drag, slowing it down\nThe more aerodynamic/smaller the form of the cyclist, the lower the drag\n\nDo not accept methods to reduce drag for this question.\nAward max 2 per type of drag.",
                "examiner_report": "In general, a poorly answered question. Further review of how form drag and surface drag affect athletes in a variety of sporting contexts is needed."
        },
        {
                "id": "B-003",
                "code": "25M.2.HL.TZ1.4b",
                "document": "B-SAQ",
                "section": "B",
                "section_name": "Biomechanics",
                "topic": "3.4 Biomechanics",
                "subtopic": "Angular Momentum",
                "question": "Explain the concept of angular momentum when a ballet dancer performs a pirouette.",
                "max_marks": 6,
                "mark_scheme": "Angular momentum is created by applying torque/an eccentric force to a body\n\nAngular momentum is defined as moment of inertia \u00d7 angular velocity OR Angular velocity and moment of inertia are inversely proportional\n\nAngular momentum is how much rotation/spin the ballet dancer has about the longitudinal/an axis\n\nA moment of inertia is determined by the distance of the load from the rotational axis\n\nAngular momentum remains constant unless the ballet dancer is acted upon by an unbalanced force\n\nBallet dancer can increase their moment of inertia by moving their limbs away from the centre of their body/axis\n\nBallet dancer can increase their angular velocity by moving their limbs close to the centre of the body/axis\n\nPicture A/Open limbs: the ballet dancer has a large moment of inertia therefore their rate of spin/angular velocity is low\n\nPicture B/Close limbs: the ballet dancer has a small moment of inertia therefore their rate of spin/angular velocity is high\n\nReference to body position or image is required for credit.",
                "examiner_report": "Well answered."
        },
        {
                "id": "C-001",
                "code": "25M.2.SL.TZ1.4a",
                "document": "C-SAQ",
                "section": "C",
                "section_name": "Sports Psychology & Motor Learning",
                "topic": "3.5 Skill Acquisition",
                "subtopic": "Motor Skill Classification",
                "question": "Running during a soccer (football) game and throwing a dart are examples of motor skills that can be classified into various continua. Using these examples, analyse the use of muscle mass and precision, and environmental impact on the skill continua.",
                "max_marks": 4,
                "mark_scheme": "Running during a soccer game is a:\n\nUse of muscle mass/precision:\n- Gross skill because it involves large muscles/movements\n\nEnvironmental impact on the performance of the skill:\n- Open skill because it involves a changing/unpredictable setting/environment\n- Externally paced skill as their speed can be determined by the movement of the opposition e.g. when tracking back to defend the goal OR Self/internally paced as the player controls how fast/when they begin running\n- Interactive skill as the performance of the skill is directly affected by the position and performance of an opponent\n\nThrowing a dart is a relatively:\n\nUse of muscle mass/precision:\n- Fine skill because it involves intricate/precise/small muscle movements\n\nEnvironmental impact on the performance of the skill:\n- Closed skill because it takes place in a fixed/stable environment\n- Self/internally paced skill because the participant begins when they are ready\n- Individual skill as the participant performs the skill whilst the opponent waits their turn\n\nMax 2 for each motor skill (throwing a dart, running during a soccer game).\nMax 1 Environmental impact on performance of each motor skill.\nThe justification for each MP is essential for the MP to be awarded.",
                "examiner_report": "Well answered. Some students did not provide sufficient detail or the correct skill continuum name."
        }
];

        // Rotating closing messages
        const CLOSING_MESSAGES = [
            "If you disagree with this feedback, brilliant! That means you're thinking critically. Bring your reasoning to your teacher or discuss with classmates.",
            "Think I've been unfair? Excellent. Challenge this score with your teacher. Defending your answer is great exam practice.",
            "Got a different interpretation? Perfect. Real examiners sometimes disagree too. Let's discuss in class.",
            "This is a starting point, not the final word. Discussing your answer with your teacher and classmates is always valuable, regardless of the score.",
            "Disagree? Good! That critical thinking is exactly what examiners want to see. Bring your case to class.",
            "AI isn't infallible (shocking, I know). If this feels wrong, talk it through with your teacher. That conversation is the real learning."
        ];

        // API endpoint
        const API_URL = 'https://sehsexam.thatjamiebloke.workers.dev/mark';

        // Current filter
        let currentSection = 'all';

        // Filter questions by section
        function filterQuestions() {
            currentSection = document.getElementById('section-filter').value;
            renderQuestions();
        }

        // Get filtered questions
        function getFilteredQuestions() {
            if (currentSection === 'all') {
                return QUESTIONS;
            }
            return QUESTIONS.filter(q => q.section === currentSection);
        }

        // Render all questions
        function renderQuestions() {
            const container = document.getElementById('questions-container');
            const noQuestionsDiv = document.getElementById('no-questions');
            const filteredQuestions = getFilteredQuestions();

            // Update count
            document.getElementById('question-count').textContent = 
                `Showing ${filteredQuestions.length} question${filteredQuestions.length !== 1 ? 's' : ''}`;

            // Clear container
            container.innerHTML = '';

            if (filteredQuestions.length === 0) {
                container.style.display = 'none';
                noQuestionsDiv.style.display = 'block';
                return;
            }

            container.style.display = 'block';
            noQuestionsDiv.style.display = 'none';

            filteredQuestions.forEach(q => {
                const questionHTML = `
                    <div class="question-card" data-question-id="${q.id}">
                        <div class="question-header">
                            <div class="question-meta">
                                <span class="section-badge section-${q.section.toLowerCase()}">${q.section}</span>
                                ${q.topic} â€¢ ${q.subtopic}
                                <span class="question-code">${q.code}</span>
                            </div>
                            <div class="question-text">${q.question}</div>
                            <span class="marks-badge">[${q.max_marks} marks]</span>
                        </div>

                        <textarea 
                            id="answer-${q.id}" 
                            placeholder="Type your answer here..."
                            aria-label="Your answer"
                        ></textarea>

                        <div class="button-group">
                            <button class="btn btn-primary" onclick="submitAnswer('${q.id}')">
                                Submit Answer
                            </button>
                            <span class="loading" id="loading-${q.id}">Marking...</span>
                        </div>

                        <div class="feedback-section" id="feedback-${q.id}">
                            <div class="score-display" id="score-${q.id}"></div>
                            <div class="disclaimer">This is an AI estimate using Claude Sonnet 4.5 with extended thinking - may not reflect an actual examiner's score</div>

                            <div class="key-points" id="key-points-${q.id}"></div>

                            <div class="examiner-comment" id="comment-${q.id}"></div>

                            <div class="closing-message" id="closing-${q.id}"></div>

                            <div style="margin-top: 20px;">
                                <button class="btn btn-secondary" onclick="showHint('${q.id}')">
                                    Show Hint
                                </button>
                                <button class="btn btn-secondary" onclick="showMarkScheme('${q.id}')">
                                    Show Mark Scheme
                                </button>
                            </div>

                            <div class="hint-section" id="hint-${q.id}">
                                <strong>ðŸ’¡ Hint</strong>
                                <p id="hint-text-${q.id}"></p>
                            </div>

                            <div class="markscheme-section" id="markscheme-${q.id}">
                                <strong>ðŸ“‹ Mark Scheme</strong>
                                <pre style="white-space: pre-wrap; font-family: inherit; margin: 10px 0;">${q.mark_scheme}</pre>
                                ${q.examiner_report ? `
                                    <div class="examiner-report">
                                        <strong>Examiner's Report:</strong>
                                        ${q.examiner_report}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += questionHTML;
            });
        }

        // Submit answer to API
        async function submitAnswer(questionId) {
            const question = QUESTIONS.find(q => q.id === questionId);
            const answer = document.getElementById(`answer-${questionId}`).value.trim();

            if (!answer) {
                alert('Please write an answer before submitting.');
                return;
            }

            // Show loading state
            document.getElementById(`loading-${questionId}`).classList.add('show');
            document.querySelector(`[onclick="submitAnswer('${questionId}')"]`).disabled = true;

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        questionId: questionId,
                        question: question.question,
                        markScheme: question.mark_scheme,
                        maxMarks: question.max_marks,
                        answer: answer
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to get feedback');
                }

                const data = await response.json();
                displayFeedback(questionId, data);

            } catch (error) {
                alert('Error getting feedback. Please try again.');
                console.error(error);
            } finally {
                document.getElementById(`loading-${questionId}`).classList.remove('show');
                document.querySelector(`[onclick="submitAnswer('${questionId}')"]`).disabled = false;
            }
        }

        // Display AI feedback
        function displayFeedback(questionId, data) {
            document.getElementById(`feedback-${questionId}`).classList.add('show');

            document.getElementById(`score-${questionId}`).textContent = 
                `I think you would score ${data.score}/${data.maxMarks} marks`;

            // Display key points
            const keyPointsHTML = data.keyPoints.map(point => 
                `<div class="key-point ${point.hit ? 'hit' : 'miss'}">
                    ${point.hit ? 'âœ“' : 'âœ—'} ${point.text}
                </div>`
            ).join('');
            document.getElementById(`key-points-${questionId}`).innerHTML = keyPointsHTML;

            // Display examiner comment
            document.getElementById(`comment-${questionId}`).innerHTML = 
                `<strong>Examiner-style comment:</strong>${data.comment}`;

            // Display random closing message
            const randomMessage = CLOSING_MESSAGES[Math.floor(Math.random() * CLOSING_MESSAGES.length)];
            document.getElementById(`closing-${questionId}`).textContent = randomMessage;

            // Store hint for later
            document.getElementById(`hint-text-${questionId}`).textContent = data.hint;
        }

        // Show hint
        function showHint(questionId) {
            const hintSection = document.getElementById(`hint-${questionId}`);
            hintSection.classList.toggle('show');
        }

        // Show mark scheme
        function showMarkScheme(questionId) {
            const schemeSection = document.getElementById(`markscheme-${questionId}`);
            schemeSection.classList.toggle('show');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', renderQuestions);
    </script>
</body>
</html>


